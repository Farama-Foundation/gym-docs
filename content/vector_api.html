<!doctype html>
<html class="no-js">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Tutorials" href="tutorials.html" /><link rel="prev" title="Spaces" href="spaces.html" />
        <link rel="canonical" href="https://www.gymlibrary.ml/content/vector_api.html" />

    <link rel="shortcut icon" href="../_static/favicon.png"/><meta name="generator" content="sphinx-4.5.0, furo 2022.06.04.1"/>
        <title>Vector API - Gym Documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?digest=40978830699223671f4072448e654b5958f38b89" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">Gym Documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../_static/img/gym_logo_black.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../_static/img/gym_logo_white.svg" alt="Dark Logo"/>
  </div>
  
  <span class="sidebar-brand-text">Gym Documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="api.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="environment_creation.html">Environment Creation</a></li>
<li class="toctree-l1"><a class="reference internal" href="spaces.html">Spaces</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Vector API</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="wrappers.html">Wrappers</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/openai/gym">Github</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Environments</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../environments/atari/index.html">Atari</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../environments/atari/adventure.html">Adventure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/atari/air_raid.html">Air Raid</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/atari/alien.html">Alien</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/atari/amidar.html">Amidar</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/atari/assault.html">Assault</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/atari/asterix.html">Asterix</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/atari/asteroids.html">Asteroids</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/atari/atlantis.html">Atlantis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/atari/bank_heist.html">Bank Heist</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/atari/battle_zone.html">Battle Zone</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/atari/beam_rider.html">Beam Rider</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/atari/berzerk.html">Berzerk</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/atari/bowling.html">Bowling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/atari/boxing.html">Boxing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/atari/breakout.html">Breakout</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/atari/carnival.html">Carnival</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/atari/centipede.html">Centipede</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/atari/chopper_command.html">Chopper Command</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/atari/crazy_climber.html">Crazy Climber</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/atari/defender.html">Defender</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/atari/demon_attack.html">Demon Attack</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/atari/double_dunk.html">Double Dunk</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/atari/elevator_action.html">Elevator Action</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/atari/enduro.html">Enduro</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/atari/fishing_derby.html">FishingDerby</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/atari/freeway.html">Freeway</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/atari/frostbite.html">Frostbite</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/atari/gopher.html">Gopher</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/atari/gravitar.html">Gravitar</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/atari/hero.html">Hero</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/atari/ice_hockey.html">IceHockey</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/atari/jamesbond.html">Jamesbond</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/atari/journey_escape.html">JourneyEscape</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/atari/kangaroo.html">Kangaroo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/atari/krull.html">Krull</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/atari/kung_fu_master.html">Kung Fu Master</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/atari/montezuma_revenge.html">Montezuma Revenge</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/atari/ms_pacman.html">Ms Pacman</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/atari/name_this_game.html">Name This Game</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/atari/phoenix.html">Phoenix</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/atari/pitfall.html">Pitfall</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/atari/pong.html">Pong</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/atari/pooyan.html">Pooyan</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/atari/private_eye.html">PrivateEye</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/atari/qbert.html">Qbert</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/atari/riverraid.html">Riverraid</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/atari/road_runner.html">Road Runner</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/atari/robotank.html">Robot Tank</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/atari/seaquest.html">Seaquest</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/atari/skiing.html">Skiings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/atari/solaris.html">Solaris</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/atari/space_invaders.html">SpaceInvaders</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/atari/star_gunner.html">StarGunner</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/atari/tennis.html">Tennis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/atari/time_pilot.html">TimePilot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/atari/tutankham.html">Tutankham</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/atari/up_n_down.html">Up n’ Down</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/atari/venture.html">Venture</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/atari/video_pinball.html">Video Pinball</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/atari/wizard_of_wor.html">Wizard of Wor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/atari/zaxxon.html">Zaxxon</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../environments/mujoco/index.html">MuJoCo</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../environments/mujoco/ant.html">Ant</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/mujoco/half_cheetah.html">Half Cheetah</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/mujoco/hopper.html">Hopper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/mujoco/humanoid_standup.html">Humanoid Standup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/mujoco/humanoid.html">Humanoid</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/mujoco/inverted_double_pendulum.html">Inverted Double Pendulum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/mujoco/inverted_pendulum.html">Inverted Pendulum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/mujoco/reacher.html">Reacher</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/mujoco/swimmer.html">Swimmer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/mujoco/walker2d.html">Walker2D</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../environments/toy_text/index.html">Toy Text</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../environments/toy_text/blackjack.html">Blackjack</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/toy_text/taxi.html">Taxi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/toy_text/cliff_walking.html">Cliff Walking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/toy_text/frozen_lake.html">Frozen Lake</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../environments/classic_control/index.html">Classic Control</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../environments/classic_control/acrobot.html">Acrobot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/classic_control/cart_pole.html">Cart Pole</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/classic_control/mountain_car_continuous.html">Mountain Car Continuous</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/classic_control/mountain_car.html">Mountain Car</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/classic_control/pendulum.html">Pendulum</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../environments/box2d/index.html">Box2D</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../environments/box2d/bipedal_walker.html">Bipedal Walker</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/box2d/car_racing.html">Car Racing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environments/box2d/lunar_lander.html">Lunar Lander</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../environments/third_party_environments/index.html">Third Party Environments</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/Farama-Foundation/gym-docs">Contribute to the Docs</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="vector-api">
<h1>Vector API<a class="headerlink" href="#vector-api" title="Permalink to this headline">#</a></h1>
<section id="vectorized-environments">
<h2>Vectorized Environments<a class="headerlink" href="#vectorized-environments" title="Permalink to this headline">#</a></h2>
<p><em>Vectorized environments</em> are environments that run multiple independent copies of the same environment in parallel using <a class="reference external" href="https://docs.python.org/3/library/multiprocessing.html">multiprocessing</a>. Vectorized environments take as input a batch of actions, and return a batch of observations. This is particularly useful, for example, when the policy is defined as a neural network that operates over a batch of observations.</p>
<p>Gym provides two types of vectorized environments:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">gym.vector.SyncVectorEnv</span></code>, where the different copies of the environment are executed sequentially.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gym.vector.AsyncVectorEnv</span></code>, where the the different copies of the environment are executed in parallel using <a class="reference external" href="https://docs.python.org/3/library/multiprocessing.html">multiprocessing</a>. This creates one process per copy.</p></li>
</ul>
<p>Similar to <code class="docutils literal notranslate"><span class="pre">gym.make</span></code>, you can run a vectorized version of a registered environment using the <code class="docutils literal notranslate"><span class="pre">gym.vector.make</span></code> function. This runs multiple copies of the same environment (in parallel, by default).</p>
<p>The following example runs 3 copies of the <code class="docutils literal notranslate"><span class="pre">CartPole-v1</span></code> environment in parallel, taking as input a vector of 3 binary actions (one for each copy of the environment), and returning an array of 3 observations stacked along the first dimension, with an array of rewards returned by each copy, and an array of booleans indicating if the episode in each parallel environment has ended.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">envs</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">vector</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="s2">&quot;CartPole-v1&quot;</span><span class="p">,</span> <span class="n">num_envs</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">envs</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">actions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">observations</span><span class="p">,</span> <span class="n">rewards</span><span class="p">,</span> <span class="n">dones</span><span class="p">,</span> <span class="n">infos</span> <span class="o">=</span> <span class="n">envs</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">actions</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">observations</span>
<span class="go">array([[ 0.00122802,  0.16228443,  0.02521779, -0.23700266],</span>
<span class="go">        [ 0.00788269, -0.17490888,  0.03393489,  0.31735462],</span>
<span class="go">        [ 0.04918966,  0.19421194,  0.02938497, -0.29495203]],</span>
<span class="go">        dtype=float32)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rewards</span>
<span class="go">array([1., 1., 1.])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dones</span>
<span class="go">array([False, False, False])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">infos</span>
<span class="go">{}</span>
</pre></div>
</div>
<p>The function <code class="docutils literal notranslate"><span class="pre">gym.vector.make</span></code> is meant to be used only in basic cases (e.g. running multiple copies of the same registered environment). For any other use-cases, please use either the <code class="docutils literal notranslate"><span class="pre">SyncVectorEnv</span></code> for sequential execution, or <code class="docutils literal notranslate"><span class="pre">AsyncVectorEnv</span></code> for parallel execution. These use-cases may include:</p>
<ul class="simple">
<li><p>Running multiple instances of the same environment with different parameters (e.g. <code class="docutils literal notranslate"><span class="pre">&quot;Pendulum-v0&quot;</span></code> with different values for the gravity).</p></li>
<li><p>Running multiple instances of an unregistered environment (e.g. a custom environment).</p></li>
<li><p>Using a wrapper on some (but not all) environment copies.</p></li>
</ul>
<section id="creating-a-vectorized-environment">
<h3>Creating a vectorized environment<a class="headerlink" href="#creating-a-vectorized-environment" title="Permalink to this headline">#</a></h3>
<p>To create a vectorized environment that runs multiple environment copies, you can wrap your parallel environments inside <code class="docutils literal notranslate"><span class="pre">gym.vector.SyncVectorEnv</span></code> (for sequential execution), or <code class="docutils literal notranslate"><span class="pre">gym.vector.AsyncVectorEnv</span></code> (for parallel execution, with <a class="reference external" href="https://docs.python.org/3/library/multiprocessing.html">multiprocessing</a>). These vectorized environments take as input a list of callables specifying how the copies are created.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">envs</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">vector</span><span class="o">.</span><span class="n">AsyncVectorEnv</span><span class="p">([</span>
<span class="gp">... </span>    <span class="k">lambda</span><span class="p">:</span> <span class="n">gym</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="s2">&quot;CartPole-v1&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="k">lambda</span><span class="p">:</span> <span class="n">gym</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="s2">&quot;CartPole-v1&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="k">lambda</span><span class="p">:</span> <span class="n">gym</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="s2">&quot;CartPole-v1&quot;</span><span class="p">)</span>
<span class="gp">... </span><span class="p">])</span>
</pre></div>
</div>
<p>Alternatively, to create a vectorized environment of multiple copies of the same registered environment, you can use the function <code class="docutils literal notranslate"><span class="pre">gym.vector.make()</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">envs</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">vector</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="s2">&quot;CartPole-v1&quot;</span><span class="p">,</span> <span class="n">num_envs</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>  <span class="c1"># Equivalent</span>
</pre></div>
</div>
<p>To enable automatic batching of actions and observations, all of the environment copies must share the same <code class="docutils literal notranslate"><span class="pre">action_space</span></code> and <code class="docutils literal notranslate"><span class="pre">observation_space</span></code>. However, all of the parallel environments are not required to be exact copies of one another. For example, you can run 2 instances of <code class="docutils literal notranslate"><span class="pre">Pendulum-v0</span></code> with different values for gravity in a vectorized environment with:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">env</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">vector</span><span class="o">.</span><span class="n">AsyncVectorEnv</span><span class="p">([</span>
<span class="gp">... </span>    <span class="k">lambda</span><span class="p">:</span> <span class="n">gym</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="s2">&quot;Pendulum-v0&quot;</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="mf">9.81</span><span class="p">),</span>
<span class="gp">... </span>    <span class="k">lambda</span><span class="p">:</span> <span class="n">gym</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="s2">&quot;Pendulum-v0&quot;</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="mf">1.62</span><span class="p">)</span>
<span class="gp">... </span><span class="p">])</span>
</pre></div>
</div>
<p>See the <code class="docutils literal notranslate"><span class="pre">Observation</span> <span class="pre">&amp;</span> <span class="pre">Action</span> <span class="pre">spaces</span></code> section for more information about automatic batching.</p>
<p>When using <code class="docutils literal notranslate"><span class="pre">AsyncVectorEnv</span></code> with either the <code class="docutils literal notranslate"><span class="pre">spawn</span></code> or <code class="docutils literal notranslate"><span class="pre">forkserver</span></code> start methods, you must wrap your code containing the vectorized environment with <code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">__name__</span> <span class="pre">==</span> <span class="pre">&quot;__main__&quot;:</span></code>. See <a class="reference external" href="https://docs.python.org/3/library/multiprocessing.html#the-spawn-and-forkserver-start-methods">this documentation</a> for more information.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">envs</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">vector</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="s2">&quot;CartPole-v1&quot;</span><span class="p">,</span> <span class="n">num_envs</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="s2">&quot;spawn&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="working-with-vectorized-environments">
<h3>Working with vectorized environments<a class="headerlink" href="#working-with-vectorized-environments" title="Permalink to this headline">#</a></h3>
<p>While standard Gym environments take a single action and return a single observation (with a reward, and boolean indicating termination), vectorized environments take a <em>batch of actions</em> as input, and return a <em>batch of observations</em>, together with an array of rewards and booleans indicating if the episode ended in each environment copy.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">envs</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">vector</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="s2">&quot;CartPole-v1&quot;</span><span class="p">,</span> <span class="n">num_envs</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">envs</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="go">array([[ 0.00198895, -0.00569421, -0.03170966,  0.00126465],</span>
<span class="go">       [-0.02658334,  0.00755256,  0.04376719, -0.00266695],</span>
<span class="go">       [-0.02898625,  0.04779156,  0.02686412, -0.01298284]],</span>
<span class="go">      dtype=float32)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">actions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">observations</span><span class="p">,</span> <span class="n">rewards</span><span class="p">,</span> <span class="n">dones</span><span class="p">,</span> <span class="n">infos</span> <span class="o">=</span> <span class="n">envs</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">actions</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">observations</span>
<span class="go">array([[ 0.00187507,  0.18986781, -0.03168437, -0.301252  ],</span>
<span class="go">       [-0.02643229, -0.18816885,  0.04371385,  0.3034975 ],</span>
<span class="go">       [-0.02803041,  0.24251814,  0.02660446, -0.29707024]],</span>
<span class="go">      dtype=float32)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rewards</span>
<span class="go">array([1., 1., 1.])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dones</span>
<span class="go">array([False, False, False])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">infos</span>
<span class="go">{}</span>
</pre></div>
</div>
<p>Vectorized environments are compatible with any environment, regardless of the action and observation spaces (e.g. container spaces like <code class="docutils literal notranslate"><span class="pre">gym.spaces.Dict</span></code>, or any arbitrarily nested spaces). In particular, vectorized environments can automatically batch the observations returned by <code class="docutils literal notranslate"><span class="pre">VectorEnv.reset</span></code> and <code class="docutils literal notranslate"><span class="pre">VectorEnv.step</span></code> for any standard Gym <code class="docutils literal notranslate"><span class="pre">Space</span></code> (e.g. <code class="docutils literal notranslate"><span class="pre">gym.spaces.Box</span></code>, <code class="docutils literal notranslate"><span class="pre">gym.spaces.Discrete</span></code>, <code class="docutils literal notranslate"><span class="pre">gym.spaces.Dict</span></code>, or any nested structure thereof). Similarly, vectorized environments can take batches of actions from any standard Gym <code class="docutils literal notranslate"><span class="pre">Space</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">DictEnv</span><span class="p">(</span><span class="n">gym</span><span class="o">.</span><span class="n">Env</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">observation_space</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Dict</span><span class="p">({</span>
<span class="gp">... </span>        <span class="s2">&quot;position&quot;</span><span class="p">:</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Box</span><span class="p">(</span><span class="o">-</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,),</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span>
<span class="gp">... </span>        <span class="s2">&quot;velocity&quot;</span><span class="p">:</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Box</span><span class="p">(</span><span class="o">-</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,),</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">... </span>    <span class="p">})</span>
<span class="gp">... </span>    <span class="n">action_space</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Dict</span><span class="p">({</span>
<span class="gp">... </span>        <span class="s2">&quot;fire&quot;</span><span class="p">:</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Discrete</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
<span class="gp">... </span>        <span class="s2">&quot;jump&quot;</span><span class="p">:</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Discrete</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
<span class="gp">... </span>        <span class="s2">&quot;acceleration&quot;</span><span class="p">:</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Box</span><span class="p">(</span><span class="o">-</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,),</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">... </span>    <span class="p">})</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">observation_space</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action</span><span class="p">):</span>
<span class="gp">... </span>        <span class="n">observation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">observation_space</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="p">(</span><span class="n">observation</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="p">{})</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">envs</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">vector</span><span class="o">.</span><span class="n">AsyncVectorEnv</span><span class="p">([</span><span class="k">lambda</span><span class="p">:</span> <span class="n">DictEnv</span><span class="p">()]</span> <span class="o">*</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">envs</span><span class="o">.</span><span class="n">observation_space</span>
<span class="go">Dict(position:Box(-1.0, 1.0, (3, 3), float32), velocity:Box(-1.0, 1.0, (3, 2), float32))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">envs</span><span class="o">.</span><span class="n">action_space</span>
<span class="go">Dict(fire:MultiDiscrete([2 2 2]), jump:MultiDiscrete([2 2 2]), acceleration:Box(-1.0, 1.0, (3, 2), float32))</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">envs</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">actions</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>    <span class="s2">&quot;fire&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span>
<span class="gp">... </span>    <span class="s2">&quot;jump&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span>
<span class="gp">... </span>    <span class="s2">&quot;acceleration&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">... </span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">observations</span><span class="p">,</span> <span class="n">rewards</span><span class="p">,</span> <span class="n">dones</span><span class="p">,</span> <span class="n">infos</span> <span class="o">=</span> <span class="n">envs</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">actions</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">observations</span>
<span class="go">{&quot;position&quot;: array([[-0.5337036 ,  0.7439302 ,  0.41748118],</span>
<span class="go">                    [ 0.9373266 , -0.5780453 ,  0.8987405 ],</span>
<span class="go">                    [-0.917269  , -0.5888639 ,  0.812942  ]], dtype=float32),</span>
<span class="go">&quot;velocity&quot;: array([[ 0.23626241, -0.0616814 ],</span>
<span class="go">                   [-0.4057572 , -0.4875375 ],</span>
<span class="go">                   [ 0.26341468,  0.72282314]], dtype=float32)}</span>
</pre></div>
</div>
<p>The environment copies inside a vectorized environment automatically call <code class="docutils literal notranslate"><span class="pre">gym.Env.reset</span></code> at the end of an episode. In the following example, the episode of the 3rd copy ends after 2 steps (the agent fell in a hole), and the paralle environment gets reset (observation <code class="docutils literal notranslate"><span class="pre">0</span></code>).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">envs</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">vector</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="s2">&quot;FrozenLake-v1&quot;</span><span class="p">,</span> <span class="n">num_envs</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">is_slippery</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">envs</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="go">array([0, 0, 0])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">observations</span><span class="p">,</span> <span class="n">rewards</span><span class="p">,</span> <span class="n">dones</span><span class="p">,</span> <span class="n">infos</span> <span class="o">=</span> <span class="n">envs</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">observations</span><span class="p">,</span> <span class="n">rewards</span><span class="p">,</span> <span class="n">dones</span><span class="p">,</span> <span class="n">infos</span> <span class="o">=</span> <span class="n">envs</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]))</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">dones</span>
<span class="go">array([False, False,  True])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">observations</span>
<span class="go">array([8, 2, 0])</span>
</pre></div>
</div>
<p>Vectorized environments will return <code class="docutils literal notranslate"><span class="pre">infos</span></code> in the form of a dictionary where each value is an array of length <code class="docutils literal notranslate"><span class="pre">num_envs</span></code> and the <em>i-th</em> value of the array represents the info of the <em>i-th</em> environment.<br />
Each <code class="docutils literal notranslate"><span class="pre">key</span></code> of the info is paired with a boolean mask <code class="docutils literal notranslate"><span class="pre">_key</span></code> representing whether or not the <em>i-th</em> environment has data.<br />
If the <em>dtype</em> of the returned info is whether <code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code>, <code class="docutils literal notranslate"><span class="pre">bool</span></code> or any <em>dtype</em> inherited from <code class="docutils literal notranslate"><span class="pre">np.number</span></code>, an array of the same <em>dtype</em> will be returned. Otherwise, the array will have <em>dtype</em> <code class="docutils literal notranslate"><span class="pre">object</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">envs</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">vector</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="s2">&quot;CartPole-v1&quot;</span><span class="p">,</span> <span class="n">num_envs</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">observations</span> <span class="o">=</span> <span class="n">envs</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">actions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">observations</span><span class="p">,</span> <span class="n">rewards</span><span class="p">,</span> <span class="n">dones</span><span class="p">,</span> <span class="n">infos</span> <span class="o">=</span> <span class="n">envs</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">actions</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">while</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="n">dones</span><span class="p">):</span>
<span class="gp">... </span>   <span class="n">observations</span><span class="p">,</span> <span class="n">rewards</span><span class="p">,</span> <span class="n">dones</span><span class="p">,</span> <span class="n">infos</span> <span class="o">=</span> <span class="n">envs</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">actions</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">dones</span><span class="p">)</span>
<span class="go">[False, True, False]</span>
<span class="go">    </span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">infos</span><span class="p">)</span>
<span class="go">{&#39;terminal_observation&#39;: array([None,</span>
<span class="go">       array([-0.11350546, -1.8090094 ,  0.23710881,  2.8017728 ], dtype=float32),</span>
<span class="go">       None], dtype=object), &#39;_terminal_observation&#39;: array([False,  True, False])}</span>
</pre></div>
</div>
</section>
</section>
<section id="observation-action-spaces">
<h2>Observation &amp; Action spaces<a class="headerlink" href="#observation-action-spaces" title="Permalink to this headline">#</a></h2>
<p>Like any Gym environment, vectorized environments contain the two properties <code class="docutils literal notranslate"><span class="pre">VectorEnv.observation_space</span></code> and <code class="docutils literal notranslate"><span class="pre">VectorEnv.action_space</span></code> to specify the observation and action spaces of the environments. Since vectorized environments operate on multiple environment copies, where the actions taken and observations returned by all of the copies are batched together, the observation and action <em>spaces</em> are batched as well so that the input actions are valid elements of <code class="docutils literal notranslate"><span class="pre">VectorEnv.action_space</span></code>, and the observations are valid elements of <code class="docutils literal notranslate"><span class="pre">VectorEnv.observation_space</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">envs</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">vector</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="s2">&quot;CartPole-v1&quot;</span><span class="p">,</span> <span class="n">num_envs</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">envs</span><span class="o">.</span><span class="n">observation_space</span>
<span class="go">Box([[-4.8 ...]], [[4.8 ...]], (3, 4), float32)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">envs</span><span class="o">.</span><span class="n">action_space</span>
<span class="go">MultiDiscrete([2 2 2])</span>
</pre></div>
</div>
<p>In order to appropriately batch the observations and actions in vectorized environments, the observation and action spaces of all of the copies are required to be identical.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">envs</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">vector</span><span class="o">.</span><span class="n">AsyncVectorEnv</span><span class="p">([</span>
<span class="gp">... </span>    <span class="k">lambda</span><span class="p">:</span> <span class="n">gym</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="s2">&quot;CartPole-v1&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="k">lambda</span><span class="p">:</span> <span class="n">gym</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="s2">&quot;MountainCar-v0&quot;</span><span class="p">)</span>
<span class="gp">... </span><span class="p">])</span>
<span class="go">RuntimeError: Some environments have an observation space different from `Box([-4.8 ...], [4.8 ...], (4,), float32)`. </span>
<span class="go">In order to batch observations, the observation spaces from all environments must be equal.</span>
</pre></div>
</div>
<p>However, sometimes it may be handy to have access to the observation and action spaces of a particular copy, and not the batched spaces. You can access those with the properties <code class="docutils literal notranslate"><span class="pre">VectorEnv.single_observation_space</span></code> and <code class="docutils literal notranslate"><span class="pre">VectorEnv.single_action_space</span></code> of the vectorized environment.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">envs</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">vector</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="s2">&quot;CartPole-v1&quot;</span><span class="p">,</span> <span class="n">num_envs</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">envs</span><span class="o">.</span><span class="n">single_observation_space</span>
<span class="go">Box([-4.8 ...], [4.8 ...], (4,), float32)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">envs</span><span class="o">.</span><span class="n">single_action_space</span>
<span class="go">Discrete(2)</span>
</pre></div>
</div>
<p>This is convenient, for example, if you instantiate a policy. In the following example, we use <code class="docutils literal notranslate"><span class="pre">VectorEnv.single_observation_space</span></code> and <code class="docutils literal notranslate"><span class="pre">VectorEnv.single_action_space</span></code> to define the weights of a linear policy. Note that, thanks to the vectorized environment, we can apply the policy directly to the whole batch of observations with a single call to <code class="docutils literal notranslate"><span class="pre">policy</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">gym.spaces.utils</span> <span class="kn">import</span> <span class="n">flatdim</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">softmax</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">policy</span><span class="p">(</span><span class="n">weights</span><span class="p">,</span> <span class="n">observations</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">logits</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">observations</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">softmax</span><span class="p">(</span><span class="n">logits</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">envs</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">vector</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="s2">&quot;CartPole-v1&quot;</span><span class="p">,</span> <span class="n">num_envs</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">flatdim</span><span class="p">(</span><span class="n">envs</span><span class="o">.</span><span class="n">single_observation_space</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">envs</span><span class="o">.</span><span class="n">single_action_space</span><span class="o">.</span><span class="n">n</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">observations</span> <span class="o">=</span> <span class="n">envs</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">actions</span> <span class="o">=</span> <span class="n">policy</span><span class="p">(</span><span class="n">weights</span><span class="p">,</span> <span class="n">observations</span><span class="p">)</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">observations</span><span class="p">,</span> <span class="n">rewards</span><span class="p">,</span> <span class="n">dones</span><span class="p">,</span> <span class="n">infos</span> <span class="o">=</span> <span class="n">envs</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">actions</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="intermediate-usage">
<h2>Intermediate Usage<a class="headerlink" href="#intermediate-usage" title="Permalink to this headline">#</a></h2>
<section id="shared-memory">
<h3>Shared memory<a class="headerlink" href="#shared-memory" title="Permalink to this headline">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">AsyncVectorEnv</span></code> runs each environment copy inside an individual process. At each call to <code class="docutils literal notranslate"><span class="pre">AsyncVectorEnv.reset</span></code> or <code class="docutils literal notranslate"><span class="pre">AsyncVectorEnv.step</span></code>, the observations of all of the parallel environments are sent back to the main process. To avoid expensive transfers of data between processes, especially with large observations (e.g. images), <code class="docutils literal notranslate"><span class="pre">AsyncVectorEnv</span></code> uses a shared memory by default (<code class="docutils literal notranslate"><span class="pre">shared_memory=True</span></code>) that processes can write to and read from at minimal cost. This can increase the throughout of the vectorized environment.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">env_fns</span> <span class="o">=</span> <span class="p">[</span><span class="k">lambda</span><span class="p">:</span> <span class="n">gym</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="s2">&quot;BreakoutNoFrameskip-v4&quot;</span><span class="p">)]</span> <span class="o">*</span> <span class="mi">5</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">envs</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">vector</span><span class="o">.</span><span class="n">AsyncVectorEnv</span><span class="p">(</span><span class="n">env_fns</span><span class="p">,</span> <span class="n">shared_memory</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">envs</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">%</span><span class="n">timeit</span> <span class="n">envs</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">envs</span><span class="o">.</span><span class="n">action_space</span><span class="o">.</span><span class="n">sample</span><span class="p">())</span>
<span class="go">2.23 ms ± 136 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">envs</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">vector</span><span class="o">.</span><span class="n">AsyncVectorEnv</span><span class="p">(</span><span class="n">env_fns</span><span class="p">,</span> <span class="n">shared_memory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">envs</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">%</span><span class="n">timeit</span> <span class="n">envs</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">envs</span><span class="o">.</span><span class="n">action_space</span><span class="o">.</span><span class="n">sample</span><span class="p">())</span>
<span class="go">1.36 ms ± 15.4 µs per loop (mean ± std. dev. of 7 runs, 1000 loops each)</span>
</pre></div>
</div>
</section>
<section id="exception-handling">
<h3>Exception handling<a class="headerlink" href="#exception-handling" title="Permalink to this headline">#</a></h3>
<p>Because sometimes things may not go as planned, the exceptions raised in any given environment copy are re-raised in the vectorized environment, even when the copy run in parallel with <code class="docutils literal notranslate"><span class="pre">AsyncVectorEnv</span></code>. This way, you can choose how to handle these exceptions yourself (with <code class="docutils literal notranslate"><span class="pre">try</span> <span class="pre">...</span> <span class="pre">except</span></code>).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">ErrorEnv</span><span class="p">(</span><span class="n">gym</span><span class="o">.</span><span class="n">Env</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">observation_space</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Box</span><span class="p">(</span><span class="o">-</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,),</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">action_space</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Discrete</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">if</span> <span class="n">action</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<span class="gp">... </span>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;An error occurred.&quot;</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">observation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">observation_space</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="p">(</span><span class="n">observation</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="p">{})</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">envs</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">vector</span><span class="o">.</span><span class="n">AsyncVectorEnv</span><span class="p">([</span><span class="k">lambda</span><span class="p">:</span> <span class="n">ErrorEnv</span><span class="p">()]</span> <span class="o">*</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">observations</span> <span class="o">=</span> <span class="n">envs</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">observations</span><span class="p">,</span> <span class="n">rewards</span><span class="p">,</span> <span class="n">dones</span><span class="p">,</span> <span class="n">infos</span> <span class="o">=</span> <span class="n">envs</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]))</span>
<span class="go">ERROR: Received the following error from Worker-2: ValueError: An error occurred.</span>
<span class="go">ERROR: Shutting down Worker-2.</span>
<span class="go">ERROR: Raising the last exception back to the main process.</span>
<span class="go">ValueError: An error occurred.</span>
</pre></div>
</div>
</section>
</section>
<section id="advanced-usage">
<h2>Advanced Usage<a class="headerlink" href="#advanced-usage" title="Permalink to this headline">#</a></h2>
<section id="custom-spaces">
<h3>Custom spaces<a class="headerlink" href="#custom-spaces" title="Permalink to this headline">#</a></h3>
<p>Vectorized environments will batch actions and observations if they are elements from standard Gym spaces, such as <code class="docutils literal notranslate"><span class="pre">gym.spaces.Box</span></code>, <code class="docutils literal notranslate"><span class="pre">gym.spaces.Discrete</span></code>, or <code class="docutils literal notranslate"><span class="pre">gym.spaces.Dict</span></code>. However, if you create your own environment with a custom action and/or observation space (inheriting from <code class="docutils literal notranslate"><span class="pre">gym.Space</span></code>), the vectorized environment will not attempt to automatically batch the actions/observations, and instead it will return the raw tuple of elements from all parallel environments.</p>
<p>In the following example, we create a new environment <code class="docutils literal notranslate"><span class="pre">SMILESEnv</span></code>, whose observations are strings representing the <a class="reference external" href="https://en.wikipedia.org/wiki/Simplified_molecular-input_line-entry_system">SMILES</a> notation of a molecular structure, with a custom observation space <code class="docutils literal notranslate"><span class="pre">SMILES</span></code>. The observations returned by the vectorized environment are contained in a tuple of strings.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">SMILES</span><span class="p">(</span><span class="n">gym</span><span class="o">.</span><span class="n">Space</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">symbols</span><span class="p">):</span>
<span class="gp">... </span>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">symbols</span> <span class="o">=</span> <span class="n">symbols</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">symbols</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">symbols</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">SMILESEnv</span><span class="p">(</span><span class="n">gym</span><span class="o">.</span><span class="n">Env</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">observation_space</span> <span class="o">=</span> <span class="n">SMILES</span><span class="p">(</span><span class="s2">&quot;][()CO=&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">action_space</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">spaces</span><span class="o">.</span><span class="n">Discrete</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">_state</span> <span class="o">=</span> <span class="s2">&quot;[&quot;</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_state</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">_state</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">observation_space</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="n">action</span><span class="p">]</span>
<span class="gp">... </span>        <span class="n">reward</span> <span class="o">=</span> <span class="n">done</span> <span class="o">=</span> <span class="p">(</span><span class="n">action</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_state</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="n">reward</span><span class="p">),</span> <span class="n">done</span><span class="p">,</span> <span class="p">{})</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">envs</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">vector</span><span class="o">.</span><span class="n">AsyncVectorEnv</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">[</span><span class="k">lambda</span><span class="p">:</span> <span class="n">SMILESEnv</span><span class="p">()]</span> <span class="o">*</span> <span class="mi">3</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">shared_memory</span><span class="o">=</span><span class="kc">False</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">envs</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">observations</span><span class="p">,</span> <span class="n">rewards</span><span class="p">,</span> <span class="n">dones</span><span class="p">,</span> <span class="n">infos</span> <span class="o">=</span> <span class="n">envs</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">observations</span>
<span class="go">(&#39;[(&#39;, &#39;[O&#39;, &#39;[C&#39;)</span>
</pre></div>
</div>
<p>Custom observation and action spaces may inherit from the <code class="docutils literal notranslate"><span class="pre">gym.Space</span></code> class. However, most use-cases should be covered by the existing space classes (e.g. <code class="docutils literal notranslate"><span class="pre">gym.spaces.Box</span></code>, <code class="docutils literal notranslate"><span class="pre">gym.spaces.Discrete</span></code>, etc…), and container classes (<code class="docutils literal notranslate"><span class="pre">gym.spaces.Tuple</span></code> and <code class="docutils literal notranslate"><span class="pre">gym.spaces.Dict</span></code>). Moreover, some implementations of reinforcement learning algorithms might not handle custom spaces properly. Use custom spaces with care.</p>
<p>If you use <code class="docutils literal notranslate"><span class="pre">AsyncVectorEnv</span></code> with a custom observation space, you must set <code class="docutils literal notranslate"><span class="pre">shared_memory=False</span></code>, since shared memory and automatic batching is not compatible with custom spaces. In general if you use custom spaces with <code class="docutils literal notranslate"><span class="pre">AsyncVectorEnv</span></code>, the elements of those spaces must be <code class="docutils literal notranslate"><span class="pre">pickleable</span></code>.</p>
</section>
</section>
<section id="api-reference">
<h2>API Reference<a class="headerlink" href="#api-reference" title="Permalink to this headline">#</a></h2>
<section id="vectorenv">
<h3>VectorEnv<a class="headerlink" href="#vectorenv" title="Permalink to this headline">#</a></h3>
<dl class="py attribute">
<dt class="sig sig-object py" id="gym.vector.VectorEnv.action_space">
<span class="sig-prename descclassname"><span class="pre">gym.vector.VectorEnv.</span></span><span class="sig-name descname"><span class="pre">action_space</span></span><a class="headerlink" href="#gym.vector.VectorEnv.action_space" title="Permalink to this definition">#</a></dt>
<dd><p>The (batched) action space. The input actions of <cite>step</cite> must be valid elements of <cite>action_space</cite>.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">envs</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">vector</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="s2">&quot;CartPole-v1&quot;</span><span class="p">,</span> <span class="n">num_envs</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">envs</span><span class="o">.</span><span class="n">action_space</span>
<span class="go">MultiDiscrete([2 2 2])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="gym.vector.VectorEnv.observation_space">
<span class="sig-prename descclassname"><span class="pre">gym.vector.VectorEnv.</span></span><span class="sig-name descname"><span class="pre">observation_space</span></span><a class="headerlink" href="#gym.vector.VectorEnv.observation_space" title="Permalink to this definition">#</a></dt>
<dd><p>The (batched) observation space. The observations returned by <cite>reset</cite> and <cite>step</cite> are valid elements of <cite>observation_space</cite>.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">envs</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">vector</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="s2">&quot;CartPole-v1&quot;</span><span class="p">,</span> <span class="n">num_envs</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">envs</span><span class="o">.</span><span class="n">observation_space</span>
<span class="go">Box([[-4.8 ...]], [[4.8 ...]], (3, 4), float32)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="gym.vector.VectorEnv.single_action_space">
<span class="sig-prename descclassname"><span class="pre">gym.vector.VectorEnv.</span></span><span class="sig-name descname"><span class="pre">single_action_space</span></span><a class="headerlink" href="#gym.vector.VectorEnv.single_action_space" title="Permalink to this definition">#</a></dt>
<dd><p>The action space of an environment copy.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">envs</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">vector</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="s2">&quot;CartPole-v1&quot;</span><span class="p">,</span> <span class="n">num_envs</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">envs</span><span class="o">.</span><span class="n">single_action_space</span>
<span class="go">Discrete(2)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="gym.vector.VectorEnv.single_observation_space">
<span class="sig-prename descclassname"><span class="pre">gym.vector.VectorEnv.</span></span><span class="sig-name descname"><span class="pre">single_observation_space</span></span><a class="headerlink" href="#gym.vector.VectorEnv.single_observation_space" title="Permalink to this definition">#</a></dt>
<dd><p>The observation space of an environment copy.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">envs</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">vector</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="s2">&quot;CartPole-v1&quot;</span><span class="p">,</span> <span class="n">num_envs</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">envs</span><span class="o">.</span><span class="n">single_action_space</span>
<span class="go">Box([-4.8 ...], [4.8 ...], (4,), float32)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="reset">
<h3>Reset<a class="headerlink" href="#reset" title="Permalink to this headline">#</a></h3>
<dl class="py method">
<dt class="sig sig-object py" id="gym.vector.VectorEnv.reset">
<span class="sig-prename descclassname"><span class="pre">VectorEnv.</span></span><span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gym.vector.VectorEnv.reset" title="Permalink to this definition">#</a></dt>
<dd><p>Reset all parallel environments and return a batch of initial observations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seed</strong> – The environment reset seeds</p></li>
<li><p><strong>return_info</strong> – If to return the info</p></li>
<li><p><strong>options</strong> – If to return the options</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>A batch of observations from the vectorized environment.</strong></p>
</dd>
</dl>
</dd></dl>

<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">envs</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">vector</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="s2">&quot;CartPole-v1&quot;</span><span class="p">,</span> <span class="n">num_envs</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">envs</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="go">array([[-0.04456399,  0.04653909,  0.01326909, -0.02099827],</span>
<span class="go">        [ 0.03073904,  0.00145001, -0.03088818, -0.03131252],</span>
<span class="go">        [ 0.03468829,  0.01500225,  0.01230312,  0.01825218]],</span>
<span class="go">        dtype=float32)</span>
</pre></div>
</div>
</section>
<section id="step">
<h3>Step<a class="headerlink" href="#step" title="Permalink to this headline">#</a></h3>
<dl class="py method">
<dt class="sig sig-object py" id="gym.vector.VectorEnv.step">
<span class="sig-prename descclassname"><span class="pre">VectorEnv.</span></span><span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">actions</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gym.vector.VectorEnv.step" title="Permalink to this definition">#</a></dt>
<dd><p>Take an action for each parallel environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>actions</strong> – element of <a class="reference internal" href="#gym.vector.VectorEnv.action_space" title="gym.vector.VectorEnv.action_space"><code class="xref py py-attr docutils literal notranslate"><span class="pre">action_space</span></code></a> Batch of actions.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>Batch of observations, rewards, done and infos</strong></p>
</dd>
</dl>
</dd></dl>

<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">envs</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">vector</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="s2">&quot;CartPole-v1&quot;</span><span class="p">,</span> <span class="n">num_envs</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">envs</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">actions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">observations</span><span class="p">,</span> <span class="n">rewards</span><span class="p">,</span> <span class="n">dones</span><span class="p">,</span> <span class="n">infos</span> <span class="o">=</span> <span class="n">envs</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">actions</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">observations</span>
<span class="go">array([[ 0.00122802,  0.16228443,  0.02521779, -0.23700266],</span>
<span class="go">        [ 0.00788269, -0.17490888,  0.03393489,  0.31735462],</span>
<span class="go">        [ 0.04918966,  0.19421194,  0.02938497, -0.29495203]],</span>
<span class="go">        dtype=float32)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rewards</span>
<span class="go">array([1., 1., 1.])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dones</span>
<span class="go">array([False, False, False])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">infos</span>
<span class="go">{}</span>
</pre></div>
</div>
</section>
<section id="seed">
<h3>Seed<a class="headerlink" href="#seed" title="Permalink to this headline">#</a></h3>
<dl class="py method">
<dt class="sig sig-object py" id="gym.vector.VectorEnv.seed">
<span class="sig-prename descclassname"><span class="pre">VectorEnv.</span></span><span class="sig-name descname"><span class="pre">seed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gym.vector.VectorEnv.seed" title="Permalink to this definition">#</a></dt>
<dd><p>Set the random seed in all parallel environments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>seed</strong> – Random seed for each parallel environment. If <code class="docutils literal notranslate"><span class="pre">seed</span></code> is a list of
length <code class="docutils literal notranslate"><span class="pre">num_envs</span></code>, then the items of the list are chosen as random
seeds. If <code class="docutils literal notranslate"><span class="pre">seed</span></code> is an int, then each parallel environment uses the random
seed <code class="docutils literal notranslate"><span class="pre">seed</span> <span class="pre">+</span> <span class="pre">n</span></code>, where <code class="docutils literal notranslate"><span class="pre">n</span></code> is the index of the parallel environment
(between <code class="docutils literal notranslate"><span class="pre">0</span></code> and <code class="docutils literal notranslate"><span class="pre">num_envs</span> <span class="pre">-</span> <span class="pre">1</span></code>).</p>
</dd>
</dl>
</dd></dl>

<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">envs</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">vector</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="s2">&quot;CartPole-v1&quot;</span><span class="p">,</span> <span class="n">num_envs</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">envs</span><span class="o">.</span><span class="n">seed</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">envs</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="go">array([[ 0.03073904,  0.00145001, -0.03088818, -0.03131252],</span>
<span class="go">        [ 0.02281231, -0.02475473,  0.02306162,  0.02072129],</span>
<span class="go">        [-0.03742824, -0.02316945,  0.0148571 ,  0.0296055 ]],</span>
<span class="go">        dtype=float32)</span>
</pre></div>
</div>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="tutorials.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Tutorials</div>
              </div>
              <svg><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="spaces.html">
              <svg><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Spaces</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2022
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            Contents
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Vector API</a><ul>
<li><a class="reference internal" href="#vectorized-environments">Vectorized Environments</a><ul>
<li><a class="reference internal" href="#creating-a-vectorized-environment">Creating a vectorized environment</a></li>
<li><a class="reference internal" href="#working-with-vectorized-environments">Working with vectorized environments</a></li>
</ul>
</li>
<li><a class="reference internal" href="#observation-action-spaces">Observation &amp; Action spaces</a></li>
<li><a class="reference internal" href="#intermediate-usage">Intermediate Usage</a><ul>
<li><a class="reference internal" href="#shared-memory">Shared memory</a></li>
<li><a class="reference internal" href="#exception-handling">Exception handling</a></li>
</ul>
</li>
<li><a class="reference internal" href="#advanced-usage">Advanced Usage</a><ul>
<li><a class="reference internal" href="#custom-spaces">Custom spaces</a></li>
</ul>
</li>
<li><a class="reference internal" href="#api-reference">API Reference</a><ul>
<li><a class="reference internal" href="#vectorenv">VectorEnv</a></li>
<li><a class="reference internal" href="#reset">Reset</a></li>
<li><a class="reference internal" href="#step">Step</a></li>
<li><a class="reference internal" href="#seed">Seed</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/scripts/furo.js"></script>
    </body>
</html>